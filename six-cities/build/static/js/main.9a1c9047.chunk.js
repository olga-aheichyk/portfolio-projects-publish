(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{69:function(e,t,a){"use strict";a.r(t);var r,s,c=a(1),i=a(24),n=a.n(i),o=a(3),l=a(5),d=a(19),u=a(13),j=a(23),m="appChanges/cityChange",b="appData/loadOffers",p="appData/loadFavoriteOffers",h="appData/updateOffers",_="appData/loadReviews",f="appData/loadNearestOffers",O="appData/addReview",v="user/authorizationRequired",x="appChanges/redirectToRoute",g="user/login",N="user/logout",y="appData/activeErrorNotification",w="appData/activeFavoriteOffersLoadingError",C="appData/changeReviewSendingStatus",R=Object(l.b)(b,(function(e){return{payload:e}})),P=Object(l.b)(m,(function(e){return{payload:e}})),E=Object(l.b)(p,(function(e){return{payload:e}})),k=Object(l.b)(h,(function(e){return{payload:e}})),S=Object(l.b)(_,(function(e){return{payload:e}})),A=Object(l.b)(f,(function(e){return{payload:e}})),q=Object(l.b)(O,(function(e){return{payload:e}})),H=Object(l.b)(v,(function(e){return{payload:e}})),T=Object(l.b)(g,(function(e){return{payload:e}})),L=Object(l.b)(x,(function(e){return{payload:e}})),I=Object(l.b)(N),D=Object(l.b)(y),F=Object(l.b)(w),U=Object(l.b)(C,(function(e){return{payload:e}})),W=Object(l.c)({offers:[],favoriteOffers:[],nearestOffers:[],reviews:[],isDataLoaded:!1,serverError:!1,favoriteOffersLoadingError:!1,isCommentSending:!1},(function(e){e.addCase(R,(function(e,t){e.offers=t.payload,e.isDataLoaded=!0,e.serverError=!1})).addCase(E,(function(e,t){e.favoriteOffers=t.payload,e.favoriteOffersLoadingError=!1,e.serverError=!1})).addCase(k,(function(e,t){var a=e.offers.findIndex((function(e){return e.id===t.payload.id}));e.offers=[].concat(Object(j.a)(e.offers.slice(0,a)),[t.payload],Object(j.a)(e.offers.slice(a+1))),e.serverError=!1})).addCase(S,(function(e,t){e.reviews=t.payload,e.serverError=!1})).addCase(A,(function(e,t){e.nearestOffers=t.payload,e.serverError=!1})).addCase(q,(function(e,t){e.reviews=t.payload})).addCase(D,(function(e){e.serverError=!0,e.isDataLoaded=!0})).addCase(F,(function(e){e.favoriteOffersLoadingError=!0})).addCase(U,(function(e,t){e.isCommentSending=t.payload}))})),z=Object(l.c)({activeCity:"Paris"},(function(e){e.addCase(P,(function(e,t){e.activeCity=t.payload}))})),M="/login",Y="/favorites",B="/offer/:id",V="/",G=["Paris","Cologne","Brussels","Amsterdam","Hamburg","Dusseldorf"],J=27,K=39,Q={POPULAR:"Popular",PRICE_LOW_TO_HIGH:"Price: low to high",PRICE_HIGH_TO_LOW:"Price: high to low",TOP_RATED_FIRST:"Top rated first"},X="AUTH",Z="NO_AUTH",$="UNKNOWN",ee="https://7.react.pages.academy/six-cities",te="/hotels",ae="/login",re="/logout",se="/comments/",ce="/favorite",ie="PLACE_CARD",ne="PROPERTY",oe={PLACE_CARD:{commonClassName:"place-card",svgWidth:18,svgHeight:19},PROPERTY:{commonClassName:"property",svgWidth:31,svgHeight:33}},le="MAIN",de="FAVORITES",ue="NEAREST",je={MAIN:{articleClassName:"cities__place-card",imgWrapperClassName:"cities__image-wrapper",imgWidth:260,imgHeight:200,infoExtraClass:""},FAVORITES:{articleClassName:"favorites__card",imgWrapperClassName:"favorites__image-wrapper",imgWidth:150,imgHeight:110,infoExtraClass:"favorites__card-info"},NEAREST:{articleClassName:"near-places__card",imgWrapperClassName:"near-places__image-wrapper",imgWidth:260,imgHeight:200,infoExtraClass:""}},me={authorizationStatus:$,userEmail:null,userAvatarUrl:null},be=Object(l.c)(me,(function(e){e.addCase(H,(function(e,t){e.authorizationStatus=t.payload})).addCase(T,(function(e,t){e.authorizationStatus=X,e.userEmail=t.payload.email,e.userAvatarUrl=t.payload.avatarUrl})).addCase(I,(function(e){e.authorizationStatus=Z,e.userEmail=null,e.userAvatarUrl=null}))})),pe="DATA",he="CHANGE",_e="USER",fe=Object(u.c)((r={},Object(d.a)(r,pe,W),Object(d.a)(r,he,z),Object(d.a)(r,_e,be),r)),Oe=a(11),ve=Object(Oe.a)(),xe=function(e){return function(e){return function(t){return t.type===x&&ve.push(t.payload),e(t)}}},ge=a(40),Ne=a.n(ge),ye=401,we=null!==(s=localStorage.getItem("token"))&&void 0!==s?s:"",Ce=a(7),Re=a(6),Pe=a(8),Ee=a(20),ke=a.n(Ee),Se=function(e){return Math.round(e)/5*100},Ae=function(e){var t=Object(Pe.a)(Object(Pe.a)({},e),{},{host:Object(Pe.a)(Object(Pe.a)({},e.host),{},{avatarUrl:e.host.avatar_url,isPro:e.host.is_pro}),isFavorite:e.is_favorite,isPremium:e.is_premium,maxAdults:e.max_adults,previewImage:e.preview_image});return delete t.host.avatar_url,delete t.host.is_pro,delete t.is_favorite,delete t.is_premium,delete t.max_adults,delete t.preview_image,t},qe=function(e){var t=Object(Pe.a)(Object(Pe.a)({},e),{},{user:Object(Pe.a)(Object(Pe.a)({},e.user),{},{avatarUrl:e.user.avatar_url,isPro:e.user.is_pro})});return delete t.user.avatar_url,delete t.user.is_pro,t},He=function(e){var t=Object(Pe.a)(Object(Pe.a)({},e),{},{avatarUrl:e.avatar_url,isPro:e.is_pro});return delete t.avatar_url,delete t.is_pro,t},Te=function(e,t){return ke()(t.date).diff(ke()(e.date))},Le=function(e){return e[_e].authorizationStatus},Ie=function(e){return e[_e].userEmail},De=function(e){return e[_e].userAvatarUrl},Fe=function(e){return e[pe].offers},Ue=function(e){return e[pe].favoriteOffers},We=function(e){return e[pe].nearestOffers},ze=function(e){return e[pe].isDataLoaded},Me=function(e){return e[pe].serverError},Ye=function(e){return e[pe].favoriteOffersLoadingError},Be=function(e){return e[pe].isCommentSending},Ve=a(0);var Ge=function(e){var t=e.render,a=e.path,r=e.exact,s=Object(o.c)(Le);return Object(Ve.jsx)(Re.b,{path:a,exact:r,render:function(e){return s===X?t(e):Object(Ve.jsx)(Re.a,{to:M})}})};var Je=function(){return Object(Ve.jsx)("p",{children:"Loading ..."})},Ke=a(9),Qe=a(17),Xe=a.n(Qe),Ze=a(16),$e=function(e){return e[he].activeCity};var et=function(){return Object(Ve.jsx)("div",{style:{display:"none"},children:Object(Ve.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",children:[Object(Ve.jsx)("symbol",{id:"icon-arrow-select",viewBox:"0 0 7 4",children:Object(Ve.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 0l3.5 2.813L7 0v1.084L3.5 4 0 1.084V0z"})}),Object(Ve.jsx)("symbol",{id:"icon-bookmark",viewBox:"0 0 17 18",children:Object(Ve.jsx)("path",{d:"M3.993 2.185l.017-.092V2c0-.554.449-1 .99-1h10c.522 0 .957.41.997.923l-2.736 14.59-4.814-2.407-.39-.195-.408.153L1.31 16.44 3.993 2.185z"})}),Object(Ve.jsx)("symbol",{id:"icon-star",viewBox:"0 0 13 12",children:Object(Ve.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 9.644L10.517 12 9.451 7.56 13 4.573l-4.674-.386L6.5 0 4.673 4.187 0 4.573 3.549 7.56 2.483 12 6.5 9.644z"})})]})})};var tt=function(){return Object(Ve.jsx)(Ce.b,{className:"header__logo-link",to:"/",children:Object(Ve.jsx)("img",{className:"header__logo",src:"img/logo.svg",alt:"6 cities logo",width:"81",height:"41"})})};function at(e){var t=e.message,a=Object(c.useState)(!0),r=Object(Ke.a)(a,2),s=r[0],i=r[1];return Object(c.useEffect)((function(){var e=setTimeout((function(){i(!1)}),5e3);return function(){clearTimeout(e)}}),[]),Object(Ve.jsx)("div",{children:s&&Object(Ve.jsx)("div",{style:{width:"600px",height:"150px",position:"fixed",top:"10px",left:"center",right:"center",backgroundColor:"red",textAlign:"center",fontSize:"40px",padding:"20px 10px",zIndex:2},children:t})})}at.defaultProps={message:"Something went wrong. Please retry later"};var rt=at;var st=function(){return Object(Ve.jsx)("nav",{className:"header__nav",children:Object(Ve.jsx)("ul",{className:"header__nav-list",children:Object(Ve.jsx)("li",{className:"header__nav-item user",children:Object(Ve.jsxs)(Ce.b,{className:"header__nav-link header__nav-link--profile",to:"/login",children:[Object(Ve.jsx)("div",{className:"header__avatar-wrapper user__avatar-wrapper"}),Object(Ve.jsx)("span",{className:"header__login",children:"Sign in"})]})})})})};var ct=function(){var e=Object(o.c)(Ie),t=Object(o.c)(De),a=Object(o.b)();return Object(Ve.jsx)("nav",{className:"header__nav",children:Object(Ve.jsxs)("ul",{className:"header__nav-list",children:[Object(Ve.jsx)("li",{className:"header__nav-item user",children:Object(Ve.jsxs)(Ce.b,{className:"header__nav-link header__nav-link--profile",to:"/favorites",children:[Object(Ve.jsx)("div",{className:"header__avatar-wrapper user__avatar-wrapper",children:t&&Object(Ve.jsx)("img",{style:{borderRadius:"50%"},src:t,alt:"User avatar"})}),Object(Ve.jsx)("span",{className:"header__user-name user__name",children:e})]})}),Object(Ve.jsx)("li",{className:"header__nav-item",children:Object(Ve.jsx)(Ce.b,{className:"header__nav-link",to:"/","data-testid":"signout",onClick:function(e){e.preventDefault(),a((function(e,t,a){return a.delete(re).then((function(){return localStorage.removeItem("token")})).then((function(){return e(I())}))}))},children:Object(Ve.jsx)("span",{className:"header__signout",children:"Sign out"})})})]})})},it=a(2),nt=a.n(it),ot=nt.a.shape({bedrooms:nt.a.number.isRequired,city:nt.a.shape({name:nt.a.oneOf(G).isRequired,location:nt.a.shape({latitude:nt.a.number.isRequired,longitude:nt.a.number.isRequired,zoom:nt.a.number.isRequired}).isRequired}).isRequired,description:nt.a.string.isRequired,goods:nt.a.arrayOf(nt.a.string),host:nt.a.shape({avatarUrl:nt.a.string,id:nt.a.oneOfType([nt.a.string,nt.a.number]).isRequired,isPro:nt.a.bool.isRequired,name:nt.a.string.isRequired}).isRequired,id:nt.a.oneOfType([nt.a.string,nt.a.number]).isRequired,images:nt.a.arrayOf(nt.a.string),isFavorite:nt.a.bool.isRequired,isPremium:nt.a.bool.isRequired,location:nt.a.shape({latitude:nt.a.number.isRequired,longitude:nt.a.number.isRequired,zoom:nt.a.number.isRequired}).isRequired,maxAdults:nt.a.number.isRequired,previewImage:nt.a.string,price:nt.a.number.isRequired,rating:nt.a.number.isRequired,title:nt.a.string.isRequired,type:nt.a.oneOf(["apartment","room","house","hotel"]).isRequired}).isRequired;nt.a.arrayOf(ot).isRequired;var lt=function(e){var t=e.details,a=e.isFavorite,r=e.id,s=Object(o.b)(),c=Number(!a);return Object(Ve.jsxs)("button",{onClick:function(){return s(function(e,t){return function(a,r,s){return s.post("".concat(ce,"/").concat(e,"/").concat(t)).then((function(e){var t=e.data;return Ae(t)})).then((function(e){return a(k(e))})).catch((function(){return a(L(M))}))}}(r,c))},className:"".concat(t.commonClassName,"__bookmark-button ").concat(a?"".concat(t.commonClassName,"__bookmark-button--active"):""," button"),type:"button",children:[Object(Ve.jsx)("svg",{className:"".concat(t.commonClassName,"__bookmark-icon"),width:t.svgWidth,height:t.svgHeight,children:Object(Ve.jsx)("use",{xlinkHref:"#icon-bookmark"})}),Object(Ve.jsx)("span",{className:"visually-hidden",children:a?"In bookmarks":"Add to bookmarks"})]})};function dt(e){var t=e.details,a=e.offer,r=e.onPlaceCardHover,s=e.onPlaceCardAwayHover,i=a.isFavorite,n=a.isPremium,o=a.id,l=a.previewImage,d=a.price,u=a.rating,j=a.title,m=a.type,b=Object(c.useState)(null),p=Object(Ke.a)(b,2),h=p[0],_=p[1];return Object(Ve.jsxs)("article",{onMouseEnter:function(e){_(e.currentTarget.id),r(e.currentTarget.id)},onMouseLeave:s,className:"".concat(t.articleClassName," place-card"),id:o,children:[n&&Object(Ve.jsx)("div",{className:"place-card__mark",children:Object(Ve.jsx)("span",{children:"Premium"})}),Object(Ve.jsx)("div",{className:"".concat(t.imgWrapperClassName," place-card__image-wrapper"),children:Object(Ve.jsx)(Ce.b,{to:"/offer/".concat(h),children:Object(Ve.jsx)("img",{className:"place-card__image",src:l,width:t.imgWidth,height:t.imgHeight,alt:"Place"})})}),Object(Ve.jsxs)("div",{className:"".concat(t.infoExtraClass," place-card__info"),children:[Object(Ve.jsxs)("div",{className:"place-card__price-wrapper",children:[Object(Ve.jsxs)("div",{className:"place-card__price",children:[Object(Ve.jsxs)("b",{className:"place-card__price-value",children:["\u20ac",d]}),Object(Ve.jsx)("span",{className:"place-card__price-text",children:"/\xa0night"})]}),Object(Ve.jsx)(lt,{details:oe[ie],isFavorite:i,id:o})]}),Object(Ve.jsx)("div",{className:"place-card__rating rating",children:Object(Ve.jsxs)("div",{className:"place-card__stars rating__stars",children:[Object(Ve.jsx)("span",{style:{width:"".concat(Se(u),"%")}}),Object(Ve.jsx)("span",{className:"visually-hidden",children:"Rating"})]})}),Object(Ve.jsx)("h2",{className:"place-card__name",children:Object(Ve.jsx)("a",{href:"/#",children:j})}),Object(Ve.jsx)("p",{className:"place-card__type",children:m})]})]})}dt.defaultProps={onPlaceCardHover:function(){},onPlaceCardAwayHover:function(){}};var ut=dt;var jt=function(e){var t=e.offers,a=e.onPlaceCardHover,r=e.onPlaceCardAwayHover;return Object(Ve.jsx)("div",{className:"cities__places-list places__list tabs__content",children:t.map((function(e){return Object(Ve.jsx)(ut,{details:je[le],offer:e,onPlaceCardHover:a,onPlaceCardAwayHover:r},e.id)}))})};var mt=function(e){var t=e.activeSortType,a=e.onSortingTypeClick,r=Object(c.useState)(!1),s=Object(Ke.a)(r,2),i=s[0],n=s[1];return Object(Ve.jsxs)("form",{className:"places__sorting",action:"#",method:"get",children:[Object(Ve.jsx)("span",{className:"places__sorting-caption",children:"Sort by"}),Object(Ve.jsxs)("span",{onClick:function(){return n((function(e){return!e}))},className:"places__sorting-type",tabIndex:"0",children:[t,Object(Ve.jsx)("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:Object(Ve.jsx)("use",{xlinkHref:"#icon-arrow-select"})})]}),Object(Ve.jsx)("ul",{onClick:function(e){a(e.target.textContent),n(!1)},className:Xe()("places__options","places__options--custom",{"places__options--opened":i}),children:Object.values(Q).map((function(e){return Object(Ve.jsx)("li",{className:Xe()("places__option",{"places__option--active":t===e}),tabIndex:"0",children:e},e)}))})]})},bt=function(e,t){switch(t){case Q.PRICE_HIGH_TO_LOW:return e.slice().sort((function(e,t){return t.price-e.price}));case Q.PRICE_LOW_TO_HIGH:return e.slice().sort((function(e,t){return e.price-t.price}));case Q.TOP_RATED_FIRST:return e.slice().sort((function(e,t){return t.rating-e.rating}));default:return e}};var pt=function(e){var t=e.activeCity,a=e.activeCityOffers,r=e.onPlaceCardHover,s=e.onPlaceCardAwayHover,i=Object(c.useState)(Q.POPULAR),n=Object(Ke.a)(i,2),o=n[0],l=n[1];return Object(Ve.jsxs)("section",{className:"cities__places places",children:[Object(Ve.jsx)("h2",{className:"visually-hidden",children:"Places"}),Object(Ve.jsxs)("b",{className:"places__found",children:[a.length," ",1===a.length?"place":"places"," to stay in ",t]}),Object(Ve.jsx)(mt,{activeSortType:o,onSortingTypeClick:function(e){l(e)}}),Object(Ve.jsx)(jt,{offers:bt(a,o),onPlaceCardHover:r,onPlaceCardAwayHover:s})]})};var ht=function(e){var t=e.activeCity;return Object(Ve.jsx)("section",{className:"cities__no-places",children:Object(Ve.jsxs)("div",{className:"cities__status-wrapper tabs__content",children:[Object(Ve.jsx)("b",{className:"cities__status",children:"No places to stay available"}),Object(Ve.jsxs)("p",{className:"cities__status-description",children:["We could not find any property available at the moment in ",t]})]})})},_t=a(18),ft=a.n(_t);a(39);var Ot=function(e,t){var a=Object(c.useState)(null),r=Object(Ke.a)(a,2),s=r[0],i=r[1];return Object(c.useEffect)((function(){if(null!==e.current&&null===s){var a=ft.a.map("map").setView({lat:t.latitude,lng:t.longitude},t.zoom);ft.a.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'}).addTo(a),i(a)}null!==e.current&&null!==s&&s.setView({lat:t.latitude,lng:t.longitude},t.zoom)}),[e,s,t]),s},vt=ft.a.icon({iconUrl:"img/pin.svg",iconSize:[J,K],iconAnchor:[J/2,K]}),xt=ft.a.icon({iconUrl:"img/pin-active.svg",iconSize:[J,K],iconAnchor:[J/2,K]}),gt=[];var Nt=function(e){var t=e.location,a=e.offers,r=e.activeOffer,s=Object(c.useRef)(null),i=Ot(s,t);return Object(c.useEffect)((function(){i&&(gt.forEach((function(e){e.remove()})),gt.length=0,a.forEach((function(e){var t=ft.a.marker({lat:e.location.latitude,lng:e.location.longitude},{icon:e.id===r.id?xt:vt});t.addTo(i),gt.push(t)})))}),[i,a,r]),Object(Ve.jsx)("div",{id:"map",style:{height:"100%",width:"100%"},ref:s})},yt=Object(Ze.a)($e,Fe,(function(e,t){return t.slice().filter((function(t){return t.city.name===e}))}));var wt=function(){var e=Object(o.c)($e),t=Object(o.c)(yt),a=Object(o.c)(Le),r=Object(o.c)(Me),s=Object(o.b)(),i=Object(c.useState)({}),n=Object(Ke.a)(i,2),l=n[0],d=n[1];return Object(Ve.jsxs)(Ve.Fragment,{children:[Object(Ve.jsx)(et,{}),Object(Ve.jsxs)("div",{className:"page page--gray page--main",children:[Object(Ve.jsx)("header",{className:"header",children:Object(Ve.jsx)("div",{className:"container",children:Object(Ve.jsxs)("div",{className:"header__wrapper",children:[r&&Object(Ve.jsx)(rt,{message:"We can't load available offers now. Please, retry later"}),Object(Ve.jsx)("div",{className:"header__left",children:Object(Ve.jsx)(tt,{})}),a===X?Object(Ve.jsx)(ct,{}):Object(Ve.jsx)(st,{})]})})}),Object(Ve.jsxs)("main",{className:Xe()("page__main","page__main--index",{"page__main--index-empty":0===t.length}),children:[Object(Ve.jsx)("h1",{className:"visually-hidden",children:"Cities"}),Object(Ve.jsx)("div",{className:"tabs",children:Object(Ve.jsx)("section",{className:"locations container",children:Object(Ve.jsx)("ul",{onClick:function(e){e.preventDefault(),s(P(e.target.textContent))},className:"locations__list tabs__list","data-testid":"city",children:G.map((function(t){return Object(Ve.jsx)("li",{className:"locations__item",children:Object(Ve.jsx)("a",{className:Xe()("locations__item-link","tabs__item",{"tabs__item--active":e===t}),href:"/#",children:Object(Ve.jsx)("span",{children:t})})},t)}))})})}),Object(Ve.jsx)("div",{className:"cities",children:Object(Ve.jsxs)("div",{className:Xe()("cities__places-container",{"cities__places-container--empty":0===t.length},"container"),children:[t.length?Object(Ve.jsx)(pt,{activeCity:e,activeCityOffers:t,onPlaceCardHover:function(e){var a=t.find((function(t){return t.id===Number(e)}));d(a)},onPlaceCardAwayHover:function(){d({})}}):Object(Ve.jsx)(ht,{activeCity:e}),Object(Ve.jsx)("div",{className:"cities__right-section",children:t.length>0&&Object(Ve.jsx)("section",{className:"cities__map map",style:{height:"100vh"},children:Object(Ve.jsx)(Nt,{location:t[0].city.location,offers:t,activeOffer:l})})})]})})]})]})]})};var Ct=function(e){var t=e.offers;return Array.from(new Set(t.slice().map((function(e){return e.city.name})))).map((function(e){return Object(Ve.jsxs)("li",{className:"favorites__locations-items",children:[Object(Ve.jsx)("div",{className:"favorites__locations locations locations--current",children:Object(Ve.jsx)("div",{className:"locations__item",children:Object(Ve.jsx)(Ce.b,{className:"locations__item-link",to:"/",children:Object(Ve.jsx)("span",{children:e})})})}),Object(Ve.jsx)("div",{className:"favorites__places",children:t.filter((function(t){return t.city.name===e})).map((function(e){return Object(Ve.jsx)(ut,{details:je[de],offer:e},e.id)}))})]},e)}))};var Rt=function(e){var t=e.favoriteOffers;return Object(Ve.jsxs)("section",{className:"favorites",children:[Object(Ve.jsx)("h1",{className:"favorites__title",children:"Saved listing"}),Object(Ve.jsx)("ul",{className:"favorites__list",children:Object(Ve.jsx)(Ct,{offers:t})})]})};var Pt=function(){return Object(Ve.jsxs)("section",{className:"favorites favorites--empty",children:[Object(Ve.jsx)("h1",{className:"visually-hidden",children:"Favorites (empty)"}),Object(Ve.jsxs)("div",{className:"favorites__status-wrapper",children:[Object(Ve.jsx)("b",{className:"favorites__status",children:"Nothing yet saved."}),Object(Ve.jsx)("p",{className:"favorites__status-description",children:"Save properties to narrow down search or plan your future trips."})]})]})};var Et=function(){var e=Object(o.c)(Ue),t=Object(o.c)(Fe),a=Object(o.c)(Ye),r=Object(o.b)();return Object(c.useEffect)((function(){r((function(e,t,a){return a.get(ce).then((function(e){return e.data.map(Ae)})).then((function(t){return e(E(t))})).catch((function(){return e(F())}))}))}),[r,t]),Object(Ve.jsxs)(Ve.Fragment,{children:[Object(Ve.jsx)(et,{}),Object(Ve.jsxs)("div",{className:"page",children:[Object(Ve.jsx)("header",{className:"header",children:Object(Ve.jsx)("div",{className:"container",children:Object(Ve.jsxs)("div",{className:"header__wrapper",children:[Object(Ve.jsx)("div",{className:"header__left",children:Object(Ve.jsx)(tt,{})}),Object(Ve.jsx)(ct,{})]})})}),Object(Ve.jsx)("main",{className:"page__main page__main--favorites",children:Object(Ve.jsxs)("div",{className:"page__favorites-container container",children:[a&&Object(Ve.jsx)(rt,{message:"We can't load your favorite offers now. Please, retry later"}),e.length?Object(Ve.jsx)(Rt,{favoriteOffers:e}):Object(Ve.jsx)(Pt,{})]})}),Object(Ve.jsx)("footer",{className:"footer container",children:Object(Ve.jsx)("a",{className:"footer__logo-link",href:"main.html",children:Object(Ve.jsx)("img",{className:"footer__logo",src:"img/logo.svg",alt:"6 cities logo",width:"64",height:"33"})})})]})]})};var kt=function(){return Object(Ve.jsxs)("section",{children:[Object(Ve.jsx)("h1",{children:"404. Page not found"}),Object(Ve.jsx)(Ce.b,{to:"/",children:"Back to the main page"})]})},St=new Map([[5,"perfect"],[4,"good"],[3,"not bad"],[2,"badly"],[1,"terribly"]]),At=50,qt=300;var Ht=function(){var e=Object(o.c)(Be),t=Object(Re.g)().id,a=Object(o.b)(),r=Object(c.useState)({rating:0,comment:""}),s=Object(Ke.a)(r,2),i=s[0],n=s[1],l=Object(c.useState)(!1),d=Object(Ke.a)(l,2),u=d[0],j=d[1],m=Object(c.useState)(!1),b=Object(Ke.a)(m,2),p=b[0],h=b[1];return Object(Ve.jsxs)("form",{onSubmit:function(e){e.preventDefault(),h(!1),a(U(!0)),a(function(e,t){var a=t.rating,r=t.comment;return function(t,s,c){return c.post("".concat(ee).concat(se).concat(e),{rating:a,comment:r}).then((function(e){return e.data.map(qe)})).then((function(e){return t(q(e))}))}}(t,i)).then((function(e){e.payload&&(n((function(e){return Object(Pe.a)(Object(Pe.a)({},e),{},{rating:0,comment:""})})),j(!1),a(U(!1)))})).catch((function(){h(!0),a(U(!1))}))},className:"reviews__form form",action:"#",method:"post",children:[p&&Object(Ve.jsx)(rt,{message:"Your review can not been sent. Please, retry later"}),Object(Ve.jsx)("label",{className:"reviews__label form__label",htmlFor:"review",children:"Your review"}),Object(Ve.jsx)("div",{className:"reviews__rating-form form__rating",children:Array.from(St).map((function(t){var a=Object(Ke.a)(t,2),r=a[0],s=a[1];return Object(Ve.jsxs)(c.Fragment,{children:[Object(Ve.jsx)("input",{onChange:function(e){var t=e.target;n((function(e){return Object(Pe.a)(Object(Pe.a)({},e),{},{rating:Number(t.value)})}))},className:"form__rating-input visually-hidden",name:"rating",value:r,id:"".concat(r,"-stars"),type:"radio",checked:i.rating===Number("".concat(r)),disabled:e}),Object(Ve.jsx)("label",{htmlFor:"".concat(r,"-stars"),className:"reviews__rating-label form__rating-label",title:s,children:Object(Ve.jsx)("svg",{className:"form__star-image",width:"37",height:"33",children:Object(Ve.jsx)("use",{xlinkHref:"#icon-star"})})})]},r)}))}),Object(Ve.jsx)("textarea",{onChange:function(e){n((function(t){return Object(Pe.a)(Object(Pe.a)({},t),{},{comment:e.target.value})})),e.target.reportValidity()&&j(!0)},className:"reviews__textarea form__textarea",id:"review",name:"review","data-testid":"textarea",value:i.comment,minLength:At,maxLength:qt,placeholder:"Tell how was your stay, what you like and what can be improved",disabled:e,required:!0}),Object(Ve.jsxs)("div",{className:"reviews__button-wrapper",children:[Object(Ve.jsxs)("p",{className:"reviews__help",children:["To submit review please make sure to set",Object(Ve.jsx)("span",{className:"reviews__star",children:"rating"}),"and describe your stay with at least",Object(Ve.jsx)("b",{className:"reviews__text-amount",children:"50 characters"}),"."]}),Object(Ve.jsx)("button",{className:"reviews__submit form__submit button",type:"submit",disabled:!i.rating||!u||e,children:"Submit"})]})]})},Tt=nt.a.shape({comment:nt.a.string.isRequired,date:nt.a.oneOfType([nt.a.instanceOf(Date),nt.a.string]).isRequired,id:nt.a.number.isRequired,rating:nt.a.number.isRequired,user:nt.a.shape({avatarUrl:nt.a.string.isRequired,id:nt.a.oneOfType([nt.a.string,nt.a.number]).isRequired,isPro:nt.a.bool.isRequired,name:nt.a.string.isRequired}).isRequired}).isRequired;nt.a.arrayOf(Tt).isRequired;var Lt=function(e){var t=e.review,a=t.comment,r=t.date,s=t.id,c=t.rating,i=t.user;return Object(Ve.jsxs)("li",{className:"reviews__item",children:[Object(Ve.jsxs)("div",{className:"reviews__user user",children:[Object(Ve.jsx)("div",{className:"reviews__avatar-wrapper user__avatar-wrapper",children:Object(Ve.jsx)("img",{className:"reviews__avatar user__avatar",src:i.avatarUrl,width:"54",height:"54",alt:"Reviews avatar ".concat(i.id)})}),Object(Ve.jsx)("span",{className:"reviews__user-name",children:i.name})]}),Object(Ve.jsxs)("div",{className:"reviews__info",children:[Object(Ve.jsx)("div",{className:"reviews__rating rating",children:Object(Ve.jsxs)("div",{className:"reviews__stars rating__stars",children:[Object(Ve.jsx)("span",{style:{width:"".concat(Se(c),"%")}}),Object(Ve.jsx)("span",{className:"visually-hidden",children:"Rating"})]})}),Object(Ve.jsx)("p",{className:"reviews__text",children:a}),Object(Ve.jsx)("time",{className:"reviews__time",dateTime:ke()(r).format("YYYY-MM-DD"),children:ke()(r).format("MMMM YYYY")})]})]},s)};var It=function(e){var t=e.reviews;return Object(Ve.jsxs)(Ve.Fragment,{children:[Object(Ve.jsxs)("h2",{className:"reviews__title",children:["Reviews \xb7",Object(Ve.jsx)("span",{className:"reviews__amount",children:t.length})]}),Object(Ve.jsx)("ul",{className:"reviews__list",children:t.map((function(e){return Object(Ve.jsx)(Lt,{review:e},e.id)}))})]})},Dt={apartment:"Apartment",room:"Private Room",house:"House",hotel:"Hotel"},Ft=Object(Ze.a)((function(e){return e[pe].reviews}),(function(e){return e.slice().sort(Te).slice(0,10)}));var Ut=function(){var e=Object(o.c)(Fe),t=Object(o.c)(Le),a=Object(o.c)(Ft),r=Object(o.c)(We),s=Object(o.c)(Me),i=Object(Re.g)().id,n=Object(o.b)();if(Object(c.useEffect)((function(){n(function(e){return function(t,a,r){return r.get("".concat(ee).concat(se).concat(e)).then((function(e){return e.data.map(qe)})).then((function(e){return t(S(e))})).catch((function(){return t(D())}))}}(i)),n(function(e){return function(t,a,r){return r.get("".concat(ee,"/hotels/").concat(e,"/nearby")).then((function(e){return e.data.map(Ae)})).then((function(e){return t(A(e))})).catch((function(){return t(D())}))}}(i))}),[n,i]),!e.find((function(e){return Number(e.id)===Number(i)})))return Object(Ve.jsx)(kt,{});var l=e.find((function(e){return Number(e.id)===Number(i)})),d=l.bedrooms,u=l.city,m=l.description,b=l.goods,p=l.host,h=l.images,_=l.isFavorite,f=l.isPremium,O=l.maxAdults,v=l.price,x=l.rating,g=l.title,N=l.type,y=h.slice(0,6),w=p.avatarUrl,C=p.isPro,R=p.name;return Object(Ve.jsxs)(Ve.Fragment,{children:[Object(Ve.jsx)(et,{}),Object(Ve.jsxs)("div",{className:"page",children:[Object(Ve.jsx)("header",{className:"header",children:Object(Ve.jsx)("div",{className:"container",children:Object(Ve.jsxs)("div",{className:"header__wrapper",children:[Object(Ve.jsx)("div",{className:"header__left",children:Object(Ve.jsx)(tt,{})}),t===X?Object(Ve.jsx)(ct,{}):Object(Ve.jsx)(st,{})]})})}),Object(Ve.jsxs)("main",{className:"page__main page__main--property",children:[Object(Ve.jsxs)("section",{className:"property",children:[s&&Object(Ve.jsx)(rt,{message:"We can't load all information about this offer. Please, retry later"}),Object(Ve.jsx)("div",{className:"property__gallery-container container",children:Object(Ve.jsx)("div",{className:"property__gallery",children:y.map((function(e){return Object(Ve.jsx)("div",{className:"property__image-wrapper",children:Object(Ve.jsx)("img",{className:"property__image",src:e,alt:N})},e.match(/\d+?(?=.jpg)/))}))})}),Object(Ve.jsx)("div",{className:"property__container container",children:Object(Ve.jsxs)("div",{className:"property__wrapper",children:[f&&Object(Ve.jsx)("div",{className:"property__mark",children:Object(Ve.jsx)("span",{children:"Premium"})}),Object(Ve.jsxs)("div",{className:"property__name-wrapper",children:[Object(Ve.jsx)("h1",{className:"property__name",children:g}),Object(Ve.jsx)(lt,{details:oe[ne],isFavorite:_,id:i})]}),Object(Ve.jsxs)("div",{className:"property__rating rating",children:[Object(Ve.jsxs)("div",{className:"property__stars rating__stars",children:[Object(Ve.jsx)("span",{style:{width:"".concat(Se(x),"%")}}),Object(Ve.jsx)("span",{className:"visually-hidden",children:"Rating"})]}),Object(Ve.jsx)("span",{className:"property__rating-value rating__value",children:x})]}),Object(Ve.jsxs)("ul",{className:"property__features",children:[Object(Ve.jsx)("li",{className:"property__feature property__feature--entire",children:Dt[N]}),Object(Ve.jsxs)("li",{className:"property__feature property__feature--bedrooms",children:[d," ",1===d?"Bedroom":"Bedrooms"]}),Object(Ve.jsxs)("li",{className:"property__feature property__feature--adults",children:["Max ",O," ",1===O?"adult":"adults"]})]}),Object(Ve.jsxs)("div",{className:"property__price",children:[Object(Ve.jsxs)("b",{className:"property__price-value",children:["\u20ac",v]}),Object(Ve.jsx)("span",{className:"property__price-text",children:"\xa0night"})]}),Object(Ve.jsxs)("div",{className:"property__inside",children:[Object(Ve.jsx)("h2",{className:"property__inside-title",children:"What's inside"}),Object(Ve.jsx)("ul",{className:"property__inside-list",children:b.map((function(e){return Object(Ve.jsx)("li",{className:"property__inside-item",children:e},e)}))})]}),Object(Ve.jsxs)("div",{className:"property__host",children:[Object(Ve.jsx)("h2",{className:"property__host-title",children:"Meet the host"}),Object(Ve.jsxs)("div",{className:"property__host-user user",children:[Object(Ve.jsx)("div",{className:"property__avatar-wrapper property__avatar-wrapper--pro user__avatar-wrapper",children:Object(Ve.jsx)("img",{className:"property__avatar user__avatar",src:w,width:"74",height:"74",alt:"Host avatar"})}),Object(Ve.jsx)("span",{className:"property__user-name",children:R}),C&&Object(Ve.jsx)("span",{className:"property__user-status",children:"Pro"})]}),Object(Ve.jsxs)("div",{className:"property__description",children:[Object(Ve.jsx)("p",{className:"property__text",children:g}),Object(Ve.jsx)("p",{className:"property__text",children:m})]})]}),Object(Ve.jsxs)("section",{className:"property__reviews reviews",children:[Object(Ve.jsx)(It,{reviews:a}),t===X&&Object(Ve.jsx)(Ht,{})]})]})}),Object(Ve.jsx)("section",{className:"property__map map",style:{maxWidth:"1144px",margin:"0 auto 50px"},children:Object(Ve.jsx)(Nt,{location:u.location,offers:[].concat(Object(j.a)(r),[l]),activeOffer:l})})]}),Object(Ve.jsx)("div",{className:"container",children:Object(Ve.jsxs)("section",{className:"near-places places",children:[Object(Ve.jsx)("h2",{className:"near-places__title",children:"Other places in the neighbourhood"}),Object(Ve.jsx)("div",{className:"near-places__list places__list",children:r.map((function(e){return Object(Ve.jsx)(ut,{details:je[ue],offer:e},e.id)}))})]})})]})]})]})};var Wt=function(){var e=Object(o.b)(),t=function(t){e(function(e){var t=e.login,a=e.password;return function(e,r,s){return s.post(ae,{email:t,password:a}).then((function(e){var t=e.data;return He(t)})).then((function(t){localStorage.setItem("token",t.token),e(T(t))})).then((function(){return e(L(V))}))}}(t))},a=Object(c.useRef)(),r=Object(c.useRef)();return Object(Ve.jsxs)("div",{className:"page page--gray page--login",children:[Object(Ve.jsx)("header",{className:"header",children:Object(Ve.jsx)("div",{className:"container",children:Object(Ve.jsxs)("div",{className:"header__wrapper",children:[Object(Ve.jsx)("div",{className:"header__left",children:Object(Ve.jsx)(tt,{})}),Object(Ve.jsx)(st,{})]})})}),Object(Ve.jsx)("main",{className:"page__main page__main--login",children:Object(Ve.jsxs)("div",{className:"page__login-container container",children:[Object(Ve.jsxs)("section",{className:"login",children:[Object(Ve.jsx)("h1",{className:"login__title",children:"Sign in"}),Object(Ve.jsxs)("form",{className:"login__form form",action:"#",method:"post",onSubmit:function(e){e.preventDefault(),r.current.value.trim()&&t({login:a.current.value,password:r.current.value})},children:[Object(Ve.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(Ve.jsx)("label",{className:"visually-hidden",htmlFor:"email",children:"E-mail"}),Object(Ve.jsx)("input",{ref:a,className:"login__input form__input",type:"email",name:"email",id:"email","data-testid":"email",placeholder:"Email",required:!0})]}),Object(Ve.jsxs)("div",{className:"login__input-wrapper form__input-wrapper",children:[Object(Ve.jsx)("label",{className:"visually-hidden",htmlFor:"password",children:"Password"}),Object(Ve.jsx)("input",{ref:r,className:"login__input form__input",type:"password",name:"password",id:"password","data-testid":"password",placeholder:"Password",required:!0})]}),Object(Ve.jsx)("button",{className:"login__submit form__submit button",type:"submit",children:"Sign in"})]})]}),Object(Ve.jsx)("section",{className:"locations locations--login locations--current",children:Object(Ve.jsx)("div",{className:"locations__item",children:Object(Ve.jsx)("a",{className:"locations__item-link",href:"/#",children:Object(Ve.jsx)("span",{children:"Amsterdam"})})})})]})})]})};var zt=function(){var e=Object(o.c)(Le),t=Object(o.c)(ze),a=Object(o.b)();return Object(c.useEffect)((function(){a((function(e,t,a){return a.get(ae).then((function(e){var t=e.data;return He(t)})).then((function(t){return e(T(t))})).catch((function(){return e(H(Z))}))}))}),[a]),Object(c.useEffect)((function(){e!==$&&a((function(e,t,a){return a.get(te).then((function(e){return e.data.map(Ae)})).then((function(t){return e(R(t))})).catch((function(){return e(D())}))}))}),[a,e]),function(e){return e===$}(e)||!t?Object(Ve.jsx)(Je,{}):Object(Ve.jsxs)(Re.d,{children:[Object(Ve.jsx)(Re.b,{exact:!0,path:V,component:wt}),Object(Ve.jsx)(Ge,{exact:!0,path:Y,render:function(){return Object(Ve.jsx)(Et,{})}}),Object(Ve.jsx)(Re.b,{exact:!0,path:M,children:e===X?Object(Ve.jsx)(Re.a,{to:V}):Object(Ve.jsx)(Wt,{})}),Object(Ve.jsx)(Re.b,{exact:!0,path:B,render:function(){return Object(Ve.jsx)(Ut,{})}}),Object(Ve.jsx)(Re.b,{children:Object(Ve.jsx)(kt,{})})]})},Mt=function(e){var t=Ne.a.create({baseURL:ee,timeout:5e3,headers:{"x-token":we}});return t.interceptors.response.use((function(e){return e}),(function(t){throw t.response.status===ye&&e(),t})),t.interceptors.request.use((function(e){return e.headers["x-token"]=localStorage.getItem("token"),e})),t}((function(){return Yt.dispatch(H(Z))})),Yt=Object(l.a)({reducer:fe,middleware:function(e){return e({thunk:{extraArgument:Mt}}).concat(xe)}});n.a.render(Object(Ve.jsx)(o.a,{store:Yt,children:Object(Ve.jsx)(Ce.a,{history:ve,children:Object(Ve.jsx)(zt,{})})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.9a1c9047.chunk.js.map